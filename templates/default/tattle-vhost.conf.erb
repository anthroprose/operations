# Graphite Apache Virtual Host
#
# Generated by Chef
<% if (node['apache']['listen_ports'] & [ node['tattle']['listen_port'].to_i, node['tattle']['listen_port'].to_s ]).empty? -%>
Listen <%= node['tattle']['listen_port'] %>
<% end -%>
NameVirtualHost *:<%= node['tattle']['listen_port'] %>

# You may need to manually edit this file to fit your needs.
<VirtualHost *:<%= node['tattle']['listen_port']%>>
        ServerName <%= node['tattle']['url'] %>
        ServerAdmin <%= node['tattle']['admin_email'] %>

        DocumentRoot "<%= node['tattle']['doc_root'] %>"
        ErrorLog /var/log/httpd/tattle-error.log
        CustomLog /var/log/httpd/tattle-access.log common

        Header set Access-Control-Allow-Origin "*"
        Header set Access-Control-Allow-Methods "GET, OPTIONS"
        Header set Access-Control-Allow-Headers "origin, authorization, accept"

        <Location "/">
                DirectoryIndex index.php
        </Location>

</VirtualHost>