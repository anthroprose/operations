{
	"name": "operations",
	"description": "The base role for the Operations Machine",
	"instance_role": "operations",
	"json_class": "Chef::Role",
	"run_list": [
		"recipe[yum]",
		"recipe[yum-epel]",
		"recipe[user]",
		"recipe[cron]",
		"recipe[rsyslog::client]",
		"recipe[git]",
		"recipe[python]",
		"recipe[python::pip]",
		"recipe[graphite]",
		"recipe[sudo]",
		"recipe[redis]",
		"recipe[java]",
		"recipe[postfix]",
		"recipe[mysql::server]",
		"recipe[nginx]",
		"recipe[elasticsearch]",
		"recipe[statsd]",
		"recipe[kibana]",
		"recipe[logstash::server]",
		"recipe[operations]",
		"recipe[operations::infrastructure]",
		"recipe[chatbot]",
		"recipe[chatbot::init]"
	],
	"override_attributes" : {
        "apache" : {
            "listen_ports" : [ "8080" ]
        },
        "graphite" : {
            "listen_port" : "8080",
            "graphite_web" : { 
                "bitmap_support" : false
            } 
        },
        "kibana" : {
            "webserver_hostname" : "kibana.internal.operations.com",
            "webserver_listen" : "*"
        },
        "elasticsearch" : {
            "allocated_memory" : "2048m",
            "version" : "0.90.11",
            "path" : {
            	"data" : "/opt/elasticsearch/data",
            	"work" : "/opt/elasticsearch/work",
            	"logs" : "/opt/elasticsearch/logs"
            }
        },
        "mysql" : {
        	"server_root_password" : "xxx",
        	"server_debian_password" : "xxx",
        	"server_repl_password" : "xxx"
        },
		"jenkins" : { 
        	"server" : { 
        		"port" : "8089",
        		"home" : "/opt/jenkins",
        		"url" : "http://jenkins.internal.operations.com"
        	} 
        }
	},
	"default_attributes" : {
		"role" : "operations",
		"diamond" : {
			"prefix" : "operations"
		},
		"rsyslog" : {
            "server_ip" : "syslog.internal.operations.com",
            "port" : "5544"
		},
		"logstash" : {
            "server" : {
                "base_config_cookbook" : "operations",
				"xmx" : "512M",
				"xms" : "512M",
				"source_file" : "https://download.elasticsearch.org/logstash/logstash/logstash-1.3.3-flatjar.jar",
				"version" : "1.3.3",
				"graphite_ip" : "graphite.internal.operations.com"
            }
		},
		"graphite" : {
			"version" : "0.9.12"
		},
		"statsd" : {
			"delete_idle_stats" : true,
			"delete_timers" : true,
			"delete_gauges" : true,
			"delete_sets" : true,
			"delete_counters" : true,
			"flush_interval" : "60000"
		},
		"nginx" : {
			"default_domain" : "localhost",
			"default_site_enabled" : false,
	        "ssl" : {
	            "city" : "Austin",
	            "state" : "TX",
	            "country" : "US"
	        },
			"sites" : {
				"proxy" : [
					{ "domain":"graphite.internal.operations.com", "directory":"/opt/graphite/webapp/content/", "proxy_location" : "http://localhost:8080" },
					{ "domain":"anthracite.internal.operations.com", "directory":"/opt/anthracite/", "proxy_location" : "http://localhost:8081" },
					{ "domain":"tattle.internal.operations.com", "directory":"/opt/tattle/", "proxy_location" : "http://localhost:8082" },
					{ "domain":"skyline.internal.operations.com", "directory":"/opt/skyline/", "proxy_location" : "http://localhost:1500" },
				 	{ "domain":"jenkins.internal.operations.com", "directory":"/opt/jenkins/", "proxy_location" : "http://localhost:8089" }
				]
			}
		},
		"authorization" : {
			"sudo" : {
				"passwordless" : true,
				"users" : ["ec2-user", "operations"]
			}
	    },
	    "tattle" : {
	    	"listen_port" : "8082",
	    	"url" : "tattle.internal.operations.com",
	    	"admin_email" : "ops@operations.com",
	    	"doc_root" : "/opt/tattle"
	    	
	    },
		"chatbot" : {
			"rooms" : ["", ""],
			"username" : "",
			"password" : "",
			"nickname" : "",
			"api_key" : ""	
		},
		"postfix" : {
			"main" : {
				"smtpd_use_tls" : false
			}
		}
	}
}